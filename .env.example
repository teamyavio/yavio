# Yavio Platform — Environment Variables
#
# Single source of truth for all packages. Copy and generate secrets:
#
#   ./scripts/setup-env.sh        # auto-generates .env with random secrets
#
# Or manually:
#   cp .env.example .env
#   # Fill in the "Required Secrets" below (see generation commands)
#
# Docker Compose reads this file automatically.
# Local dev scripts (pnpm dev, pnpm migrate) also load from here.

# ─── Required Secrets ────────────────────────────────────────────────────────
# Generate each with: openssl rand -base64 32

NEXTAUTH_SECRET=           # Session encryption (dashboard)
JWT_SECRET=                # Widget JWT signing (ingest)
API_KEY_HASH_SECRET=       # HMAC for API key hashing (shared between ingest + dashboard)
ENCRYPTION_KEY=            # AES-256-GCM for OAuth token encryption (dashboard)

# ─── Database Passwords ──────────────────────────────────────────────────────
# Used by Docker Compose for the DB containers.
# In production, replace with strong random values.

POSTGRES_SERVICE_PASSWORD=yavio_dev      # yavio_service role: table owner, bypasses RLS
POSTGRES_APP_PASSWORD=yavio_dev          # yavio_app role: RLS enforced (user-facing queries)
CLICKHOUSE_PASSWORD=yavio_dev            # default user: runs migrations
CLICKHOUSE_INGEST_PASSWORD=yavio_dev     # yavio_ingest user: INSERT only
CLICKHOUSE_DASHBOARD_PASSWORD=yavio_dev  # yavio_dashboard user: SELECT only, row policies

# ─── Database Connection URLs ────────────────────────────────────────────────
# localhost for local dev; Docker Compose overrides these with container hostnames.

DATABASE_URL=postgres://yavio_service:yavio_dev@localhost:5432/yavio
CLICKHOUSE_URL=http://default:yavio_dev@localhost:8123

# ─── Dashboard ───────────────────────────────────────────────────────────────

NEXTAUTH_URL=http://localhost:3000       # Auth callback URL
APP_URL=http://localhost:3000            # Public-facing app URL (emails, links)

# OAuth providers (optional — omit to disable)
# GITHUB_CLIENT_ID=
# GITHUB_CLIENT_SECRET=
# GOOGLE_CLIENT_ID=
# GOOGLE_CLIENT_SECRET=

# Email / SMTP (optional — if unset, email features are disabled)
# SMTP_HOST=                   # e.g. smtp.resend.com
# SMTP_PORT=587                # 587 for STARTTLS, 465 for TLS
# SMTP_USER=
# SMTP_PASSWORD=
# SMTP_FROM=noreply@example.com

# ─── Ingest API ──────────────────────────────────────────────────────────────

# PORT=3001                    # Ingest server port (default: 3001)
# CORS_ORIGINS=http://localhost:3000,http://localhost:3002   # Comma-separated (default: *)

# ─── Yavio Cloud Only (never set by self-hosters) ────────────────────────────
# YAVIO_CLOUD=true
# STRIPE_SECRET_KEY=
# STRIPE_WEBHOOK_SECRET=
# STRIPE_PRO_PRICE_ID=
